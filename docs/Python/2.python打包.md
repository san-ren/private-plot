
# PyInstaller
#263238
#282c34
### 1. 安装
`pip install PyInstaller`
### 2. 带参数打包
```python
pyinstaller -F -w -i icon.ico your_script.py
```
- `-F`：打包为单文件
- `-w`：隐藏控制台（适合GUI程序）
- `-i`：指定exe图标（需.ico格式）



### 3. 输出结构
- 生成`dist`文件夹包含exe文件
- `build`文件夹为临时文件可删除

### 4. 使用UPX压缩
[upx: UPX - the Ultimate Packer for eXecutables](https://github.com/upx/upx)

解压后，将UPX所在目录加入系统PATH

添加系统变量后，PyInstaller 打包时会自动检测并使用 UPX 压缩：

    pyinstaller -F -w your_script.py

### 一、动态导入模块未被识别的解决方法

1. **显式指定隐藏模块**  
    PyInstaller无法自动检测动态导入的模块（如`importlib.import_module()`或条件导入），需通过`--hidden-import`手动添加：
    
    bash
    
    ```
    pyinstaller --hidden-import=模块名 --hidden-import=子模块名 your_script.py
    ```
    
    示例：若动态导入`comtypes.stream`，则添加`--hidden-import=comtypes.stream`<sup class="footnote-item"><span class="md__linkx" onclick="jumpToLink(event)" data-text="python打包exe文件-实现记录_comtypes.stream-CSDN博客" data-idx="3" data-link="https://blog.csdn.net/weixin_72186894/article/details/140607772">3</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="pyinstaller 打包后的exe程序运行的时候说缺少各种依赖包" data-idx="4" data-link="https://blog.csdn.net/qq_33192454/article/details/140116881">4</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="python打包时遇见第三方包有隐藏依赖或者出现依赖错误-CSDN博客" data-idx="5" data-link="https://blog.csdn.net/weixin_42883164/article/details/136815874">5</span></sup>。
    
2. **修改`.spec`文件**  
    在生成的`.spec`文件中，找到`Analysis`段，添加`hiddenimports`列表：
    
    python
    
    ```
    a = Analysis(    ...,    hiddenimports=['模块名', '子模块名'],)
    ```
    
    例如，添加`hiddenimports=['sklearn.utils._cython_blas']`解决缺失的隐式依赖<sup class="footnote-item"><span class="md__linkx" onclick="jumpToLink(event)" data-text="pyinstaller 打包问题小记_pyinstaller打包漏掉包-CSDN博客" data-idx="2" data-link="https://blog.csdn.net/qq_28215385/article/details/107062698">2</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="pyinstaller 打包问题小记-CSDN技术社区" data-idx="8" data-link="https://m.blog.csdn.net/qq_28215385/article/details/107062698">8</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="pyinstaller打包命令-博客园" data-idx="9" data-link="https://www.cnblogs.com/liuliu1/p/18623745">9</span></sup>。
    

---

### 二、静态文件（非代码资源）未打包的解决方法

1. **通过命令行添加资源**  
    使用`--add-data`参数指定资源路径，格式为`源路径;目标路径`：
    
    bash
    
    ```
    pyinstaller --add-data="config.json;." --add-data="templates/*;templates/" your_script.py
    ```
    
    此命令会将本地`config.json`和`templates/`目录下的文件打包到生成的临时目录中<sup class="footnote-item"><span class="md__linkx" onclick="jumpToLink(event)" data-text="python打包时遇见第三方包有隐藏依赖或者出现依赖错误-CSDN博客" data-idx="5" data-link="https://blog.csdn.net/weixin_42883164/article/details/136815874">5</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="pyinstaller的打包Python(包含静态文件）-CSDN技术社区" data-idx="6" data-link="https://m.blog.csdn.net/qq_59636442/article/details/144071283">6</span>&nbsp;<span class="md__linkx" onclick="jumpToLink(event)" data-text="Pyinstaller如何打包携带静态文件？我来告诉你答案-CSDN技术社区" data-idx="10" data-link="https://m.blog.csdn.net/wyt2wyt/article/details/145505468">10</span></sup>。
    
2. **在`.spec`文件中配置`datas`**  
    编辑`.spec`文件的`Analysis`段，添加`datas`元组列表：
    
    python
    
    ```
    a = Analysis(    ...,    datas=[('本地资源路径', '目标目录名'), ('config.json', '.')],)
    ```
    
    例如，`datas=[('static/images', 'images')]`会将本地`static/images`目录打包到临时目录的`images`下



### 打包命令优化：

 启用多核编译
 ```python
python -m PyInstaller --noconfirm --clean --log-level WARN auto_generated.spec
```


 显示详细打包过程
  ```python
python -m PyInstaller --log-level DEBUG auto_generated.spec
```

 强制清理缓存
 ```python
python -m PyInstaller --clean --noconfirm auto_generated.spec
```

















